# Migration `20200929234621-init`

This migration has been generated by Charles Nguyen at 9/29/2020, 7:46:21 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Client" (
"id" SERIAL,
"first_name" text   NOT NULL ,
"last_name" text   NOT NULL ,
"age" integer   NOT NULL ,
"email" text   NOT NULL ,
"phone" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Produce" (
"id" SERIAL,
"name" text   NOT NULL ,
"quantity" integer   NOT NULL ,
"price" Decimal(65,30)   NOT NULL ,
"type" text   NOT NULL ,
"storeId" integer   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Receipt" (
"id" SERIAL,
"subtotal" Decimal(65,30)   NOT NULL ,
"total" Decimal(65,30)   NOT NULL ,
"clientId" integer   NOT NULL ,
"storeId" integer   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Store" (
"id" SERIAL,
"name" text   NOT NULL ,
"address" text   NOT NULL ,
"email" text   NOT NULL ,
"storeOwner" text   NOT NULL ,
"city" text   NOT NULL ,
"province" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_ProduceToReceipt" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE UNIQUE INDEX "_ProduceToReceipt_AB_unique" ON "public"."_ProduceToReceipt"("A", "B")

CREATE INDEX "_ProduceToReceipt_B_index" ON "public"."_ProduceToReceipt"("B")

ALTER TABLE "public"."Produce" ADD FOREIGN KEY ("storeId")REFERENCES "public"."Store"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Receipt" ADD FOREIGN KEY ("clientId")REFERENCES "public"."Client"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Receipt" ADD FOREIGN KEY ("storeId")REFERENCES "public"."Store"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ProduceToReceipt" ADD FOREIGN KEY ("A")REFERENCES "public"."Produce"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ProduceToReceipt" ADD FOREIGN KEY ("B")REFERENCES "public"."Receipt"("id") ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE "public"."test"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200929234621-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,84 @@
+//npx prisma migrate save --experimental (save prisma data model)
+//npx prisma migrate up --experimental (apply migration to database)
+//npx prisma generate (Regenerate prisma client to see new changes added and expose CRUD queries to the new models)
+
+// 1. Manually adjust your Prisma data model.
+// 2. Migrate your database using the prisma migrate CLI commands we covered.
+// 3. (Re-)generate Prisma Client
+// 4. Use Prisma Client in your application code to access your database.
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Client {
+  id Int @id @default(autoincrement())
+  first_name String
+  last_name String
+  age Int
+  email String
+  phone String
+
+  // Relations
+  receipts Receipt[]
+
+  // Logs
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Produce {
+  id Int @id @default(autoincrement())
+  name String
+  quantity Int
+  price Float
+  type String
+
+  // Relations
+  store Store @relation(fields: [storeId], references: [id])
+  storeId Int
+  receipt Receipt[] // Many to many
+
+  // Logs
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Receipt {
+  id Int @id @default(autoincrement())
+  subtotal Float
+  total Float
+
+  // Relations
+  client Client @relation(fields: [clientId], references: [id])
+  clientId Int
+  store Store @relation(fields: [storeId], references: [id])
+  storeId Int
+  produces Produce[] // Many to many
+
+  // Logs
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Store {
+  id Int @id @default(autoincrement())
+  name String
+  address String
+  email String
+  storeOwner String
+  city String
+  province String
+
+  // Relations
+  receipts Receipt[]
+
+  // Logs
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
```


